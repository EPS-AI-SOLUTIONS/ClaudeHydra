version: '3.8'

services:
  hydra:
    build: .
    container_name: hydra-core
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      - ./.hydra-data:/app/.hydra-data
      - ./.serena:/app/.serena
      - ./hydra.config.json:/app/hydra.config.json
    environment:
      - OLLAMA_HOST=http://host.docker.internal:11434
    extra_hosts:
      - "host.docker.internal:host-gateway"

  # Optional Dashboard (Rust)
  dashboard:
    build: 
      context: ./src/dashboard
      dockerfile: ../../Dockerfile.dashboard # Assuming separate dockerfile later
    profiles: ["ui"]
    ports:
      - "8080:8080"
