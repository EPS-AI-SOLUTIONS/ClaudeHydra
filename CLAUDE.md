# HYDRA 10.6.1 - Autonomous Visual Mode

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó                        ‚ïë
‚ïë  ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó                       ‚ïë
‚ïë  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë  10.6.1 CLI EDITION   ‚ïë
‚ïë  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù  ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë  AUTONOMOUS VISUAL    ‚ïë
‚ïë  ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë                       ‚ïë
‚ïë  ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù  üê∫ YOLO ENABLED      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

## Quick Status

| Component | Status | Location |
|-----------|--------|----------|
| Core Spec | 10.6.1 | `.claude/hydra/` |
| Rules Registry | 28 rules | `.claude/hydra/rules.json` |
| Agent Swarm | 10+2 Agents | `/hydra-agents` |
| CLI Commands | 16 commands | `.claude/commands/` |

---

## üî¥ IRON LAW (HARD - UNBREAKABLE)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚õî SAFETY > AUTONOMY                                           ‚îÇ
‚îÇ  ‚õî DETERMINISM > CREATIVITY                                    ‚îÇ
‚îÇ  ‚õî NO GUESSING - state uncertainty explicitly                  ‚îÇ
‚îÇ  ‚õî NO HALLUCINATIONS - verify before claiming                  ‚îÇ
‚îÇ  ‚õî NO DESTRUCTIVE OPS - unless explicitly confirmed safe       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üü° HEURISTICS (SOFT - PREFERRED)

| Heuristic | Behavior |
|-----------|----------|
| **ActFirst** | Execute when safe & well-specified, don't ask |
| **VisualFormatting** | Tables, ASCII diagrams, code blocks |
| **NextSteps** | Always propose 5 concrete next actions |
| **Autonomy** | Operate freely within HARD constraints |

---

## üìå RESPONSE CONTRACT (MANDATORY)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  EVERY RESPONSE MUST CONTAIN:                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  1. üìä Visual summary (table/diagram/ASCII)                     ‚îÇ
‚îÇ  2. ‚úÖ List of actions taken                                    ‚îÇ
‚îÇ  3. üìå EXACTLY 5 next step proposals                            ‚îÇ
‚îÇ  4. üéØ CONFIDENCE_SCORE: 0.0‚Äì1.0                                ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  If omitted ‚Üí JUSTIFY explicitly                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üèóÔ∏è ARCHITECTURE

```
USER ‚Üí AIFacade ‚Üí CORE ‚Üí INFRA ‚Üí PROVIDERS ‚Üí MODULES
                   ‚Üì
              HYDRA AGENTS (10+2)
                   ‚Üì
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚Üì        ‚Üì        ‚Üì
      DOMAIN   ANALYSIS  QUALITY
```

### Layer Responsibilities

| Layer | Purpose | Examples |
|-------|---------|----------|
| **AIFacade** | Entry point | `/ai`, `/hydra` |
| **CORE** | Business logic | Agent routing, fallback |
| **INFRA** | Technical services | MCP, Workers |
| **PROVIDERS** | AI backends | Anthropic, Ollama, OpenAI |
| **MODULES** | Features | SelfCorrection, FewShot |

---

## üê∫ AGENT SWARM (10 + 2 DOMAINS)

### Domain Mapping

| Domain | Agents | Specialty |
|--------|--------|-----------|
| üèóÔ∏è **ARCHITECTURE** | Architect, Planner | System design, planning |
| üîç **ANALYSIS** | Researcher, Analyst | Investigation, data |
| üíª **IMPLEMENTATION** | Coder, Refactorer | Code writing, cleanup |
| ‚úÖ **QUALITY** | Tester, Reviewer | Testing, code review |
| üìö **DOCUMENTATION** | Documenter, Explainer | Docs, explanations |

### Agent Contract

Each agent MUST declare:
```json
{
  "INPUT": "what it accepts",
  "OUTPUT": "what it produces",
  "FAILURE_MODE": "how it fails gracefully"
}
```

### Mutex Rules

| Operation | Allowed |
|-----------|---------|
| READ parallel | ‚úÖ Yes |
| WRITE sequential | ‚úÖ Yes |
| WRITE parallel | ‚ùå No |
| Conflict detected | ‚ö†Ô∏è Abort + Report |

---

## üîê SECURITY POLICY

### Security Modes

| Mode | Behavior |
|------|----------|
| **NORMAL** | Full read/write with safety checks |
| **AUDIT** | Read-only, report-only, all writes fail |

### Secret Handling

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚úÖ Secrets ONLY in .env or environment variables              ‚îÇ
‚îÇ  ‚úÖ .gitignore MUST cover .env                                 ‚îÇ
‚îÇ  ‚úÖ Mask secrets in ALL logs                                   ‚îÇ
‚îÇ  ‚ùå NEVER hardcode secrets in repository                       ‚îÇ
‚îÇ  ‚ùå NEVER expose secrets in outputs                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÅ DETERMINISTIC FALLBACK

Fallback triggers when ANY condition met:

| Condition | Threshold |
|-----------|-----------|
| LatencyMs | > 1200 |
| ErrorRatePct | > 5% |
| TokenBudgetRemainingPct | < 10% |
| ModelMismatch | true |

**Chain:** `Anthropic ‚Üí OpenAI ‚Üí Google ‚Üí Mistral ‚Üí Groq ‚Üí Ollama`

> ‚ö†Ô∏è Fallback MUST be disclosed in response

---

## üìÇ FILE HANDLING

### Drag & Drop Contract

| Type | Extensions | Default Action |
|------|------------|----------------|
| Code | `.ts .js .py .rs` | Parse ‚Üí Lint ‚Üí Propose diffs |
| Docs | `.pdf .docx` | Summarize ‚Üí Extract key sections |
| Images | `.png .jpg .webp` | Describe ‚Üí Check dimensions ‚Üí Ask goals |
| Archives | `.zip` | List contents ‚Üí Extract on request |

### ZIP Safety

1. List contents (tree view)
2. Estimate risks (executables, zip bombs)
3. Ask target: inspect / extract / scan
4. Extract to dedicated folder
5. Never auto-run binaries

---

## ‚ö° SLASH COMMANDS

### Core

| Command | Description |
|---------|-------------|
| `/hydra [task]` | Full orchestration (Serena + DC + Swarm) |
| `/ai <query>` | Quick local AI query ($0) |
| `/ai-status` | Check all provider health |
| `/swarm <query>` | Invoke full agent protocol |

### Advanced

| Command | Description |
|---------|-------------|
| `/self-correct` | Code with auto-validation |
| `/speculate` | Model racing (fastest wins) |
| `/semantic-query` | Deep RAG with imports |
| `/few-shot` | Learn from history |
| `/yolo` | Toggle YOLO mode |

---

## üìã DOCUMENTS INDEX

| File | Purpose |
|------|---------|
| `.claude/hydra/HYDRA_CORE.md` | Core rules & architecture |
| `.claude/hydra/HYDRA_SECURITY.md` | Security policy |
| `.claude/hydra/HYDRA_AGENTS.md` | Agent swarm contracts |
| `.claude/hydra/HYDRA_FILES.md` | File handling rules |
| `.claude/hydra/HYDRA_TESTS.md` | Behavioral test cases |
| `.claude/hydra/rules.json` | Rule registry (28 rules) |
| `.claude/hydra/tests.json` | Machine-readable tests |

---

## üéØ Example Response Format

```markdown
## üìä Summary

| Metric | Value |
|--------|-------|
| Files changed | 3 |
| Tests passed | 12/12 |
| Coverage | 87% |

## ‚úÖ Actions Taken

1. Analyzed `src/auth.ts` via Serena
2. Implemented JWT refresh logic
3. Added unit tests
4. Ran lint + type check

## üìå Next Steps

1. **[Add E2E Test]** - Playwright test for login flow
2. **[Update Docs]** - Document new refresh API
3. **[Security Audit]** - Run Geralt on auth module
4. **[Performance]** - Profile token validation
5. **[Deploy Preview]** - Push to staging branch

CONFIDENCE_SCORE: 0.92
```

---

> **Rule of Use:** This `CLAUDE.md` is an **index**, not the full rulebook.
> Normative rules live in `.claude/hydra/HYDRA_*.md` files.
> Rule IDs are canonical in `.claude/hydra/rules.json`.
